# 可视化编辑功能测试指南

## 测试环境准备

1. 确保项目已启动：`npm run dev`
2. 确保后端服务正常运行
3. 准备一个测试应用（有生成代码的应用）

## 测试步骤

### 1. 基础功能测试

#### 1.1 页面加载测试
- [ ] 进入应用对话页面
- [ ] 确认页面正常加载
- [ ] 确认右侧预览区域显示网页内容

#### 1.2 编辑模式按钮测试
- [ ] 确认编辑模式按钮在输入框左侧显示
- [ ] 确认按钮只在有编辑权限时显示
- [ ] 确认按钮只在网页加载完成后显示

#### 1.3 编辑模式切换测试
- [ ] 点击编辑模式按钮进入编辑模式
- [ ] 确认按钮状态变为激活状态
- [ ] 再次点击按钮退出编辑模式
- [ ] 确认按钮状态恢复正常

### 2. 元素选择测试

#### 2.1 悬浮效果测试
- [ ] 进入编辑模式
- [ ] 鼠标悬浮在网页元素上
- [ ] 确认元素显示蓝色虚线边框
- [ ] 确认鼠标指针变为十字形

#### 2.2 元素选中测试
- [ ] 点击网页元素
- [ ] 确认元素边框变为绿色实线
- [ ] 确认输入框上方显示选中元素信息
- [ ] 确认Alert组件显示正确的元素信息

#### 2.3 元素信息显示测试
- [ ] 确认Alert组件显示元素标签
- [ ] 确认Alert组件显示元素文本内容
- [ ] 点击Alert组件的关闭按钮
- [ ] 确认选中状态被清除

### 3. 消息发送测试

#### 3.1 无选中元素发送测试
- [ ] 不选中任何元素
- [ ] 输入提示词并发送
- [ ] 确认消息正常发送
- [ ] 确认提示词不包含元素信息

#### 3.2 有选中元素发送测试
- [ ] 选中一个网页元素
- [ ] 输入提示词并发送
- [ ] 确认消息包含元素信息
- [ ] 确认发送后自动退出编辑模式
- [ ] 确认选中状态被清除

#### 3.3 元素信息格式测试
- [ ] 确认提示词包含以下信息：
  - 元素标签
  - 选择器
  - 文本内容
  - 页面路径
  - 位置坐标
  - 尺寸信息

### 4. 边界情况测试

#### 4.1 权限测试
- [ ] 使用无编辑权限的用户访问
- [ ] 确认编辑模式按钮不显示
- [ ] 确认无法进入编辑模式

#### 4.2 网络异常测试
- [ ] 在编辑模式下断开网络
- [ ] 确认功能正常降级
- [ ] 确认不会出现错误

#### 4.3 页面刷新测试
- [ ] 在编辑模式下刷新页面
- [ ] 确认编辑状态被正确重置
- [ ] 确认不会出现状态残留

## 预期结果

### 成功标准
1. 编辑模式按钮正常显示和切换
2. 元素悬浮和选中效果正常
3. 元素信息正确显示和清除
4. 消息发送时正确包含元素信息
5. 发送后自动退出编辑模式
6. 无权限用户无法使用编辑功能

### 错误处理
1. 网络异常时功能正常降级
2. 页面刷新时状态正确重置
3. 不会出现JavaScript错误
4. 不会影响原有功能

## 测试工具

- 浏览器开发者工具
- 网络面板监控请求
- 控制台查看错误信息
- 元素面板检查DOM变化

## 常见问题

### Q: 编辑模式按钮不显示
A: 检查是否有编辑权限，网页是否已加载完成

### Q: 元素选择无效果
A: 检查iframe是否正常加载，控制台是否有错误

### Q: 消息发送失败
A: 检查网络连接，后端服务是否正常

### Q: 元素信息不完整
A: 检查iframe内的脚本是否正确注入
